% AUTHOR: Nicklas Vraa
% A collection of packages, commands, and settings for setting
% the metadata of a document.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{meta}

\RequirePackage{fancyhdr, geometry, lastpage, xparse}

% SIZE: ------------------------------------------------------------------------
\NewDocumentCommand{\size}{mg}{% Argument 2 is optional.
    \IfValueTF{#2}{%
        \geometry{paper= #1paper, #2}
    }{
        \geometry{paper= #1paper}
    }
}

% MARGINS: ---------------------------------------------------------------------
\NewDocumentCommand{\margins}{mggg}{% Arguments 2,3,4 are optional.
    \IfValueTF{#4}{% If four arguments are given.
        \geometry{top=#1, bottom=#2, left=#3, right=#4}%
    }{%
        \IfValueTF{#3}{% If three arguments are given.
            \geometry{top=#1, bottom=#1, left=#2, right=#3}%
        }{%
            \IfValueTF{#2}{% If two arguments are given.
                \geometry{top=#1, bottom=#1, left=#2, right=#2}%
            }{% If one argument is given.
                \geometry{top=#1, bottom=#1, left=#1, right=#1}%
            }
        }
    }
    \fancyhfoffset[O]{0pt}
}

% LANGUAGE: --------------------------------------------------------------------
\NewDocumentCommand{\lang}{m}{%
    \RequirePackage[#1]{babel}
    \newcommand{\theLanguage}{#1}%
}

% HEADER: ----------------------------------------------------------------------
\NewDocumentCommand{\header}{mgg}{%
    \newcommand{\theLeftHeader}{#1}%
    \IfValueT{#2}{%
        \newcommand{\theCenterHeader}{#2}%
    }
    \IfValueT{#3}{%
        \newcommand{\theRightHeader}{#3}%
    }
}

% TITLE: -----------------------------------------------------------------------
\NewCommandCopy{\oldtitle}{\title}%
\RenewDocumentCommand{\title}{m}{%
    \newcommand{\theTitle}{#1}%
}

% SUBTITLE: --------------------------------------------------------------------
\NewDocumentCommand{\subtitle}{m}{%
\newcommand{\theSubtitle}{#1}%
}

% AUTHOR: ----------------------------------------------------------------------
\NewCommandCopy{\oldauthor}{\author}%
\RenewDocumentCommand{\author}{m}{%
    \newcommand{\theAuthor}{#1}%
}

% DATE: ------------------------------------------------------------------------
\NewCommandCopy{\olddate}{\date}%
\RenewDocumentCommand{\date}{m}{%
    \newcommand{\theDate}{#1}%
}
